# Контейнизирано Full-Stack Приложение за Гласуване
- Този проект съдържа просто **full-stack** уеб приложение за анкета, напълно контейнеризирано с **Docker** и оркестрирано чрез **Docker Compose**. Проектът е разработен като практическа задача с цел да демонстрира процеса по контейнеризация на мултисервисно приложение от нулата.

## Бързи връзки
- **Docker Hub изображение:** https://hub.docker.com/repository/docker/stefantriv/poll-backend/tags

## 1. Преглед на проекта
- Основната цел е да се приложат основите на **Docker** в реална ситуация с няколко услуги. Приложението представлява проста анкета, в която потребителите гласуват за любим език за програмиране. Резултатите се показват в динамична лента, която се обновява в реално време след всеки глас.
-Този проект показва как да се изолират различни компоненти на приложение (бекенд и база данни) в отделни контейнери, да се дефинират взаимодействията между тях и как всичко това да се стартира с една единствена команда.

## 2.  Основни технологии и инструменти
- Бекенд: **Node.js**, **Express.js**, **mysql2** пакет
- База данни: **MySQL 8.0**
- Контейнеризация: **Docker**, **Docker Compose**
- Фронтенд: **HTML, CSS, JavaScript** (без фреймуърк)
- Контрол на версиите: **Git**
- Хостване на кода: **GitHub**
- Регистър за изображения: **Docker Hub**
- Редактор и терминал: **Visual Studio Code**

## 3.  Структура на проекта
```bash

/
├── backend/
│   ├── Dockerfile         # Инструкция за изграждане на Node.js изображение.
│   ├── index.html         # Едностраничният интерфейс.
│   ├── package.json       # Node.js зависимости и скриптове.
│   └── server.js          # Express логика, API и връзка с базата.
│
└── compose.yml            # Главният файл, който дефинира и свързва услугите.
```
## 4.  Как работи всяка част
### poll-app - Бекенд услуга
- Технология: **Node.js + Express.js**
- Функции:
Служи като сървър и обслужва **index.html**
- **REST API**:
- **GET /poll:** Връща всички опции и техните гласове
- **POST /vote/:id:** Увеличава броя гласове за конкретна опция

-При първоначално стартиране: сървърът инициализира базата с няколко езика за гласуване

### poll-db - Услуга за база данни
- Технология: Официален образ **mysql:8.0**
- Функции:
-- Съхранява всички данни от анкетата
-- Използва именуван volume poll-db-data за трайно съхранение (данните се запазват дори при изтриване на контейнера)

## 5.  Docker конфигурация
- **Dockerfile** (в директорията backend/)
```dockerfile
FROM node:18-alpine
WORKDIR /usr/src/app
COPY package*.json ./
RUN npm install
COPY . .
EXPOSE 3000
CMD ["node", "server.js"]
```
- **compose.yaml**
```yaml
services:
  poll-app:
    build: ./backend
    ports:
      - "3000:3000"
    environment:
      - DB_HOST=poll-db
      - DB_USER=poll_user
      - DB_PASSWORD=secret
      - DB_NAME=polling
    depends_on:
      - poll-db

  poll-db:
    image: mysql:8.0
    environment:
      - MYSQL_ROOT_PASSWORD=root
      - MYSQL_DATABASE=polling
      - MYSQL_USER=poll_user
      - MYSQL_PASSWORD=secret
    volumes:
      - poll-db-data:/var/lib/mysql

volumes:
  poll-db-data:
```
## 6.  Комуникация между услугите
-Автоматична мрежа:** Docker Compose** създава вътрешна мрежа и свързва двата контейнера.
-**Service Discovery:** Услугите се откриват по име – бекендът комуникира с базата чрез **poll-db:3306**.
- Променливи на средата: Използвани за конфигуриране на връзката в **server.js**
- Устойчивост: Бекендът има **retry loop** за повторно свързване, ако базата все още не е готова.

## 7.  Стартиране на приложението
- Изисквания:
- Git
- Docker Desktop

 ### Инструкции
- Клонираме на хранилището:

```bash
git clone https://github.com/Stefan0703/docker-poll-app-assignment
```
- Навигираме до проекта:

```bash
cd docker-poll-app
```
- Стартираме контейнерите:

```bash

docker compose up --build
```
- Изчакваме съобщението:
Polling app server is running on http://localhost:3000

- Отворяме в браузъра:

http://localhost:3000

-Спиранме приложението:
- В терминала натискаме Ctrl + C
- Почистваме (спиране + изтриване на volumes):

```bash

docker compose down --volumes
```
--volumes е важно – премахва volume-а poll-db-data, за да се инициализира базата отначало при следващ старт.

